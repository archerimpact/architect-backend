/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.11 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var r;for(r=0;r<e.length&&(!e[r]||!t(e[r],r,e));r+=1);}}function eachReverse(e,t){if(e){var r;for(r=e.length-1;r>-1&&(!e[r]||!t(e[r],r,e));r-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var r;for(r in e)if(hasProp(e,r)&&t(e[r],r))break}function mixin(e,t,r,i){return t&&eachProp(t,function(t,n){(r||!hasProp(e,n))&&(!i||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[n]=t:(e[n]||(e[n]={}),mixin(e[n],t,r,i)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,r,i){var n=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n.requireType=e,n.requireModules=i,r&&(n.originalError=r),n}function newContext(e){function t(e){var t,r,i=e.length;for(t=0;i>t;t++)if(r=e[t],"."===r)e.splice(t,1),t-=1;else if(".."===r){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function r(e,r,i){var n,o,a,s,c,u,h,l,f,d,p,g=r&&r.split("/"),m=g,b=E.map,v=b&&b["*"];if(e&&"."===e.charAt(0)&&(r?(m=g.slice(0,g.length-1),e=e.split("/"),h=e.length-1,E.nodeIdCompat&&jsSuffixRegExp.test(e[h])&&(e[h]=e[h].replace(jsSuffixRegExp,"")),e=m.concat(e),t(e),e=e.join("/")):0===e.indexOf("./")&&(e=e.substring(2))),i&&b&&(g||v)){a=e.split("/");e:for(s=a.length;s>0;s-=1){if(u=a.slice(0,s).join("/"),g)for(c=g.length;c>0;c-=1)if(o=getOwn(b,g.slice(0,c).join("/")),o&&(o=getOwn(o,u))){l=o,f=s;break e}!d&&v&&getOwn(v,u)&&(d=getOwn(v,u),p=s)}!l&&d&&(l=d,f=p),l&&(a.splice(0,f,l),e=a.join("/"))}return n=getOwn(E.pkgs,e),n?n:e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function n(e){var t=getOwn(E.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function a(e,t,i,n){var a,s,c,u,h=null,l=t?t.name:null,f=e,d=!0,p="";return e||(d=!1,e="_@r"+(C+=1)),u=o(e),h=u[0],e=u[1],h&&(h=r(h,l,n),s=getOwn(T,h)),e&&(h?p=s&&s.normalize?s.normalize(e,function(e){return r(e,l,n)}):r(e,l,n):(p=r(e,l,n),u=o(p),h=u[0],p=u[1],i=!0,a=w.nameToUrl(p))),c=!h||s||i?"":"_unnormalized"+(A+=1),{prefix:h,name:p,parentMap:t,unnormalized:!!c,url:a,originalName:f,isDefine:d,id:(h?h+"!"+p:p)+c}}function s(e){var t=e.id,r=getOwn(k,t);return r||(r=k[t]=new w.Module(e)),r}function c(e,t,r){var i=e.id,n=getOwn(k,i);!hasProp(T,i)||n&&!n.defineEmitComplete?(n=s(e),n.error&&"error"===t?r(n.error):n.on(t,r)):"defined"===t&&r(T[i])}function u(e,t){var r=e.requireModules,i=!1;t?t(e):(each(r,function(t){var r=getOwn(k,t);r&&(r.error=e,r.events.error&&(i=!0,r.emit("error",e)))}),i||req.onError(e))}function h(){globalDefQueue.length&&(apsp.apply(_,[_.length,0].concat(globalDefQueue)),globalDefQueue=[])}function l(e){delete k[e],delete S[e]}function f(e,t,r){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,n){var o=i.id,a=getOwn(k,o);!a||e.depMatched[n]||r[o]||(getOwn(t,o)?(e.defineDep(n,T[o]),e.check()):f(a,t,r))}),r[i]=!0)}function d(){var e,t,r=1e3*E.waitSeconds,o=r&&w.startTime+r<(new Date).getTime(),a=[],s=[],c=!1,h=!0;if(!v){if(v=!0,eachProp(S,function(e){var r=e.map,u=r.id;if(e.enabled&&(r.isDefine||s.push(e),!e.error))if(!e.inited&&o)n(u)?(t=!0,c=!0):(a.push(u),i(u));else if(!e.inited&&e.fetched&&r.isDefine&&(c=!0,!r.prefix))return h=!1}),o&&a.length)return e=makeError("timeout","Load timeout for modules: "+a,null,a),e.contextName=w.contextName,u(e);h&&each(s,function(e){f(e,{},{})}),o&&!t||!c||!isBrowser&&!isWebWorker||q||(q=setTimeout(function(){q=0,d()},50)),v=!1}}function p(e){hasProp(T,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,r,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(r,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function b(){var e;for(h();_.length;){if(e=_.shift(),null===e[0])return u(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));p(e)}}var v,x,w,y,q,E={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},k={},S={},M={},_=[],T={},O={},R={},C=1,A=1;return y={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?T[e.map.id]=e.exports:e.exports=T[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(E.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},x=function(e){this.events=getOwn(M,e.id)||{},this.map=e,this.shim=getOwn(E.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},x.prototype={init:function(e,t,r,i){i=i||{},this.inited||(this.factory=t,r?this.on("error",r):this.events.error&&(r=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=r,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;O[e]||(O[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,r=this.map.id,i=this.depExports,n=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{n=w.execCb(r,o,i,n)}catch(a){e=a}else n=w.execCb(r,o,i,n);if(this.map.isDefine&&void 0===n&&(t=this.module,t?n=t.exports:this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",u(this.error=e)}else n=o;this.exports=n,this.map.isDefine&&!this.ignore&&(T[r]=n,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),l(r),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=a(e.prefix);this.depMaps.push(i),c(i,"defined",bind(this,function(i){var n,o,h,f=getOwn(R,this.map.id),d=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,g=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(d=i.normalize(d,function(e){return r(e,p,!0)})||""),o=a(e.prefix+"!"+d,this.map.parentMap),c(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=getOwn(k,o.id),void(h&&(this.depMaps.push(o),this.events.error&&h.on("error",bind(this,function(e){this.emit("error",e)})),h.enable()))):f?(this.map.url=w.nameToUrl(f),void this.load()):(n=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),n.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(k,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&l(e.map.id)}),u(e)}),n.fromText=bind(this,function(r,i){var o=e.name,c=a(o),h=useInteractive;i&&(r=i),h&&(useInteractive=!1),s(c),hasProp(E.config,t)&&(E.config[o]=E.config[t]);try{req.exec(r)}catch(l){return u(makeError("fromtexteval","fromText eval for "+t+" failed: "+l,l,[t]))}h&&(useInteractive=!0),this.depMaps.push(c),w.completeLoad(o),g([o],n)}),void i.load(e.name,g,n,E))})),w.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var r,i,n;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,n=getOwn(y,e.id))return void(this.depExports[t]=n(this));this.depCount+=1,c(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&c(e,"error",bind(this,this.errback))}r=e.id,i=k[r],hasProp(y,r)||!i||i.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(k,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var r=this.events[e];r||(r=this.events[e]=[]),r.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:E,contextName:e,registry:k,defined:T,urlFetched:O,defQueue:_,Module:x,makeModuleMap:a,nextTick:req.nextTick,onError:u,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=E.shim,r={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){r[t]?(E[t]||(E[t]={}),mixin(E[t],e,!0,!0)):E[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(R[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,r){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),t[r]=e}),E.shim=t),e.packages&&each(e.packages,function(e){var t,r;e="string"==typeof e?{name:e}:e,r=e.name,t=e.location,t&&(E.paths[r]=e.location),E.pkgs[r]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(k,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function o(r,i,c){var h,l,f;return n.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof r?isFunction(i)?u(makeError("requireargs","Invalid require call"),c):t&&hasProp(y,r)?y[r](k[t.id]):req.get?req.get(w,r,t,o):(l=a(r,t,!1,!0),h=l.id,hasProp(T,h)?T[h]:u(makeError("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(b(),w.nextTick(function(){b(),f=s(a(null,t)),f.skipMap=n.skipMap,f.init(r,i,c,{enabled:!0}),d()}),o)}return n=n||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var i,n=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==n&&(!a||n>1)&&(i=e.substring(n,e.length),e=e.substring(0,n)),w.nameToUrl(r(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(T,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(T,e)||hasProp(k,e)}}),t||(o.undef=function(e){h();var r=a(e,t,!0),n=getOwn(k,e);i(e),delete T[e],delete O[r.url],delete M[e],eachReverse(_,function(t,r){t[0]===e&&_.splice(r,1)}),n&&(n.events.defined&&(M[e]=n.events),l(e))}),o},enable:function(e){var t=getOwn(k,e.id);t&&s(e).enable()},completeLoad:function(e){var t,r,i,o=getOwn(E.shim,e)||{},a=o.exports;for(h();_.length;){if(r=_.shift(),null===r[0]){if(r[0]=e,t)break;t=!0}else r[0]===e&&(t=!0);p(r)}if(i=getOwn(k,e),!t&&!hasProp(T,e)&&i&&!i.inited){if(!(!E.enforceDefine||a&&getGlobal(a)))return n(e)?void 0:u(makeError("nodefine","No define call for "+e,null,[e]));p([e,o.deps||[],o.exportsFn])}d()},nameToUrl:function(e,t,r){var i,n,o,a,s,c,u,h=getOwn(E.pkgs,e);if(h&&(e=h),u=getOwn(R,e))return w.nameToUrl(u,t,r);if(req.jsExtRegExp.test(e))s=e+(t||"");else{for(i=E.paths,n=e.split("/"),o=n.length;o>0;o-=1)if(a=n.slice(0,o).join("/"),c=getOwn(i,a)){isArray(c)&&(c=c[0]),n.splice(0,o,c);break}s=n.join("/"),s+=t||(/^data\:|\?/.test(s)||r?"":".js"),s=("/"===s.charAt(0)||s.match(/^[\w\+\.\-]+:/)?"":E.baseUrl)+s}return E.urlArgs?s+((-1===s.indexOf("?")?"?":"&")+E.urlArgs):s},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,r,i){return t.apply(i,r)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return n(t.id)?void 0:u(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.11",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&""+opera=="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,r,i){var n,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=r,r=i):e=[]),o&&o.context&&(a=o.context),n=getOwn(contexts,a),n||(n=contexts[a]=req.s.newContext(a)),o&&n.configure(o),n.require(e,t,r)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},req.load=function(e,t,r){var i,n=e&&e.config||{};if(isBrowser)return i=req.createNode(n,t,r),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&(""+i.attachEvent).indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=r,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(r),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+r,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,r){var i,n;"string"!=typeof e&&(r=t,t=e,e=null),isArray(t)||(r=t,t=null),!t&&isFunction(r)&&(t=[],r.length&&((""+r).replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,r){t.push(r)}),t=(1===r.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),n=contexts[i.getAttribute("data-requirecontext")])),(n?n.defQueue:globalDefQueue).push([e,t,r])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),define("shared/utils/color",["require","exports","module"],function(e,t,r){r.exports={hexToString:function(e){var t=e.toString(16);return t="000000".substr(0,6-t.length)+t},rgbToHsv:function(e){var t=0,r=e.r,i=e.g,n=e.b,o=i>r&&n>r?r:n>i?i:n,a=r>i&&r>n?r:i>n?i:n,s=0===a?0:(a-o)/a,c=0===s?1e-5:a-o;switch(a){case r:t=(i-n)/c;break;case i:t=2+(n-r)/c;break;case n:t=4+(r-i)/c}return{h:(1e3+t/6)%1,s:s,v:a}},hsvToRgb:function(e){var t=e.h,r=e.s,i=e.v;t=(t+1e3)%1;var n=0,o=0,a=0,s=6*t>>0,c=6*t-s,u=i*(1-r),h=i*(1-r*c),l=i*(1-r*(1-c));switch(s){case 0:n=i,o=l,a=u;break;case 1:n=h,o=i,a=u;break;case 2:n=u,o=i,a=l;break;case 3:n=u,o=h,a=i;break;case 4:n=l,o=u,a=i;break;case 5:n=i,o=u,a=h}return{r:n,g:o,b:a}},rgbToCmyk:function(e){var t=1-e.r,r=1-e.g,i=1-e.b,n=r>t&&i>t?t:i>r?r:i;return 1===n?t=r=i=0:(t=(t-n)/(1-n),r=(r-n)/(1-n),i=(i-n)/(1-n)),{c:t,m:r,y:i,k:n}},cmykToRgb:function(e){var t=e.k;return{r:1-(e.c*(1-t)+t),g:1-(e.m*(1-t)+t),b:1-(e.y*(1-t)+t)}},rgbToXyz:function(e){var t=e.r,r=e.g,i=e.b;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;var n=100*(.4124*t+.3576*r+.1805*i)/95.047,o=.2126*t+.7152*r+.0722*i,a=100*(.0193*t+.1192*r+.9505*i)/108.883;return{x:n,y:o,z:a}},xyzToRgb:function(e){var t=e.x,r=e.y,i=e.z;t*=95.047/100,i*=1.08883;var n=3.24063*t-1.53721*r-.498629*i,o=-.968931*t+1.87576*r+.0415175*i,a=.0557101*t-.204021*r+1.057*i;return n=n>.0031308?1.055*Math.pow(n,.4167)-.055:12.92*n,o=o>.0031308?1.055*Math.pow(o,.4167)-.055:12.92*o,a=a>.0031308?1.055*Math.pow(a,.4167)-.055:12.92*a,{r:n,g:o,b:a}},rgbToLab:function(e){var t=this.rgbToXyz(e),r=t.x,i=t.y,n=t.z,o=r>.008856?Math.pow(r,1/3):7.787*r+.1379,a=i>.008856?Math.pow(i,1/3):7.787*i+.1379,s=n>.008856?Math.pow(n,1/3):7.787*n+.1379;return{l:(116*a-16)/100,a:(500*(o-a)+128)/255,b:(200*(a-s)+128)/255}},labToRgb:function(e){var t=(100*e.l+16)/116,r=t+(255*e.a-128)/500,i=t-(255*e.b-128)/200;return this.xyzToRgb({x:r>.2069?r*r*r:.1284*(r-.1379),y:t>.2069?t*t*t:.1284*(t-.1379),z:i>.2069?i*i*i:.1284*(i-.1379)})},labToLAB:function(e){var t=[];return t[0]=100*e[0],t[1]=255*e[1]-128,t[2]=255*e[2]-128,t},labToLABInverse:function(e){var t=[];return t[0]=e[0]/100,t[1]=(e[1]+128)/255,t[2]=(e[2]+128)/255,t},valuesToRgb:function(e,t){function r(e){return 0>e?0:e>1?1:e}var i,n,o,a;switch(e){case"lab":n={l:t[0],a:t[1],b:t[2]},i=this.labToRgb(n);break;case"rgb":i={r:t[0],g:t[1],b:t[2]};break;case"cmyk":o={c:t[0],m:t[1],y:t[2],k:t[3]},i=this.cmykToRgb(o);break;case"hsv":a={h:t[0],s:t[1],v:t[2]},i=this.hsvToRgb(a)}return i={r:r(i.r),g:r(i.g),b:r(i.b)}},valuesToHex:function(e,t){var r=this.valuesToRgb(e,t);return this.hexToString((Math.round(255*r.r)<<16|Math.round(255*r.g)<<8|Math.round(255*r.b))>>>0).toUpperCase()}}}),define("utils/image_extraction",["require","exports","module","shared/utils/color"],function(e,t,r){function i(e){if(window.Float64Array)return new Float64Array(e);for(var t=Array(e);--e>=0;)t[e]=0;return t}function n(e,t){if(window.Float64Array){var r=new Float64Array(e);return r.set(t),r}for(var i=Array(e),n=0;e>n;n++)i[n]=t[n];return i}function o(e){return n(b,e)}function a(e,t,r){var i=4*(t+r*e._width);return{r:e._data.data[i],g:e._data.data[i+1],b:e._data.data[i+2],a:e._data.data[i+3]}}function s(){}function c(e,t,r){this._data=e,this._width=t,this._height=r}function u(e,t,r,i,n,o){return e.density<T||t.density<T?O:(_=s.weightedDistanceLab(e.color,t.color,n,o),M=r>_?O:0,r>_?M*(1-_/r):i*(1/_-1/r))}function h(e,t){this.color=e,this.density=t}function l(e){var t,r;switch(e){case"Bright":t=.88,r=.75;break;case"Dark":t=-.8,r=-.8;break;case"Muted":t=-.8,r=.6;break;case"Deep":t=.6,r=-.7;break;case"Colorful":t=.5,r=0;break;case"Blank":t=0,r=0;break;default:t=.5,r=0}this.gHH=1,this.gSS=.23,this.gBB=.04,this.colorRepulsion=2.5,this.hardCoreInteractionRadius=4,this.saturationScaleFactor=1,this.style=e,this.colorfulnessEnhancement=t,this.shadowHighlightSuppression=r}function f(){this._colors=[],this.points=[],this._numColors=null,this._xMultiplier=1,this._yMultiplier=1,this._xOffset=0,this._yOffset=0,this._harmonyPoints=[]}var d=e("shared/utils/color"),p=64,g=64,m=10,b=p*g*m;s.weight=function(e,t,r,i,n){var o=.001,a=s.suppression(s.colorfulness(e,t,r),i)*s.suppression(r,n)*s.tripleCubicSigmoid(t,0,30)*s.tripleCubicSigmoid(r,0,30);return o>a?o:a},s.colorfulness=function(e,t,r){var i=d.rgbToLab(d.hsvToRgb({h:e/255,s:t/255,v:r/255})),n=2*i.a-1,o=2*i.b-1;return 255*Math.sqrt(.5*(n*n+o*o))},s.tripleCubicSigmoid=function(e,t,r){var i=r-t;return i>0?s.cubicSigmoid((e-t)/i):1},s.suppression=function(e,t){0>t&&(t*=-1,e=255-e);var r=e/255,i=.5>t?2*t:1,n=.5>t?0:2*t-1;return Math.pow(i*s.cubicSigmoid(r)+(1-i),1+3*n)},s.cubicSigmoid=function(e){if(0>e)return 0;if(e>1)return 1;var t=2*e-1;return.5*(1+t*(1.5-.5*t*t))};var v,x;s.hsvToLab=function(e){v=e.hsv,e.rgb=d.hsvToRgb({h:v.h,s:v.s,v:v.v}),x=d.rgbToLab(e.rgb),x.l*=255,x.a*=255,x.b*=255,e.gregLab=x};var w,y,q,E,k,S;s.weightedDistanceLab=function(e,t,r,i){e.gregLab||s.hsvToLab(e),t.gregLab||s.hsvToLab(t),w=e.gregLab.l,E=t.gregLab.l,y=e.gregLab.a,k=t.gregLab.a,q=e.gregLab.b,S=t.gregLab.b;var n=w-E,o=y-k,a=q-S,c=Math.sqrt(y*y+q*q),u=Math.sqrt(k*k+S*S),h=c-u,l=h*h,f=o*o+a*a-l;return Math.sqrt(r*n*n+i*l+f)};var M,_,T=1e-10,O=1.79769e305;h.harmonyPointsSort=function(e,t){var r=e.color.hsv,i=t.color.hsv;return r.h>i.h?-1:r.h<i.h?1:r.s>i.s?-1:r.s<i.s?1:r.v>i.v?-1:r.v<i.v?1:0},f.prototype.extractColors=function(e,t,r){this._bitmapData=e,this._colorStyle=t,this._numColors=r,this.synchronousExtract()},f.prototype.synchronousExtract=function(){this.clearHistogram(),this.generateHistogram(),this.weightAndNormalizeHistogram(),this.findBestColors(),this.findBestPoints()},f.prototype.clearHistogram=function(){this._histogram=i(b)},f.prototype.generateHistogram=function(){var e,t,r,n,o,s,c,u=this._bitmapData,h=this._yOffset,l=this._xOffset,f=this._yMultiplier,v=this._xMultiplier,x=p,w=g,y=m,q=255/256*x,E=255/256*w,k=255/256*y,S=this._bitmapData._width,M=this._bitmapData._height,_=this._histogram||i(b);for(s=h;M>s;s+=f)for(o=l;S>o;o+=v)c=a(u,o,s),c.r/=255,c.g/=255,c.b/=255,n=d.rgbToHsv(c),e=~~(n.h*q),t=~~(n.s*E),r=~~(n.v*k),_[(e*g+t)*m+r]++;this._histogram=_},f.prototype.weightAndNormalizeHistogram=function(){var e=this._numColors,t=this.weightAndNormalize(),r=t.volume;e>r&&(this._colorStyle=new l("Blank"),r=this.weightAndNormalize(),this._numColors=Math.min(r,e))},f.prototype.weightAndNormalize=function(){var e,t,r,i,n,a,c,u=this._colorStyle.colorfulnessEnhancement,h=this._colorStyle.shadowHighlightSuppression,l=o(this._histogram),f=0,d=p,b=g,v=m;for(t=0;d>t;t++)for(n=~~((256*t+d/2)/d),n>255&&(n=255),r=0;b>r;r++)for(a=~~((256*r+b/2)/b),a>255&&(a=255),i=0;v>i;i++)0!==l[(t*g+r)*m+i]&&(c=~~(256*(i+.5)/v),e=l[(t*g+r)*m+i]*=s.weight(n,a,c,u,h),e>f&&(f=e));var x,w,y=.01,q=f>y?Math.log(f/y):0,E=0;if(q>0)for(t=0;d>t;t++)for(r=0;b>r;r++)for(i=0;v>i;i++)x=(t*g+r)*m+i,0!==l[x]&&(e=l[x],w=e>y?Math.log(e/y)/q:0,0!==w&&E++,l[x]=w);return this._weightedHistogram=l,{volume:E}},f.prototype.findBestColors=function(){var e,t,r,i,n,o,a,s=this._colorStyle,c=this._numColors,l=this._weightedHistogram,f=p,d=g,b=m,v=[];for(e=0;f>e;e++)for(i=~~(1.411*~~((256*e+f/2)/f)),t=0;d>t;t++)for(n=~~((256*t+d/2)/d*.392),n>100&&(n=100),r=0;b>r;r++)0!==l[(e*g+t)*m+r]&&(o=~~(256*(r+.5)/b*.392),a={hsv:{h:i/360,s:n/100,v:o/100}},v.push(new h(a,l[(e*g+t)*m+r])));var x,w,y,q,E,k,S=s.hardCoreInteractionRadius,M=s.colorRepulsion,_=s.gBB,T=s.gSS,O=[];for(x=0;c>x;x++){for(q=Math.pow(10,100),w=0;w<v.length;w++){for(E=1-v[w].density,y=0;y<O.length;y++)E+=u(v[w],O[y],S,M,_,T);q>E&&(q=E,k=v[w])}O.push(k)}this._harmonyPoints=O},f.prototype.findBestPoints=function(){var e=this._harmonyPoints;e.sort(h.harmonyPointsSort);for(var t=0;t<e.length;t++)this._colors.push(e[t].color),this.points.push(this.findPixel(this._colors[t]))},f.prototype.findPixel=function(e){for(var t=this._bitmapData,r=this._bitmapData._width,i=this._bitmapData._height,n=255*e.rgb.r,o=255*e.rgb.g,s=255*e.rgb.b,c=1.79769e305,u=12,h=0,l=0,f=!1,d=0;!f&&i>d;d++)for(var p=0;!f&&r>p;p++){var g=a(t,p,d),m=g.r-n,b=g.g-o,v=g.b-s,x=m*m+b*b+v*v;c>x&&(h=p,l=d,c=x,u>=x&&(f=!0))}return{x:h,y:l}},r.exports=function(e,t,r,i,n){var o=new f,a=new c(e,t,r),s=new l(n);return o.extractColors(a,s,i),o.points},r.exports.findPixels=function(e,t){var r=new f;r._bitmapData=new c(e,e.width,e.height);var i=[];return t.forEach(function(e){i.push(r.findPixel(e))}),i}}),require.config({baseUrl:"/build01/resource/js"}),self.window=self,require(["require","shared/utils/color","utils/image_extraction"],function(e,t,r){self.extractColorFromImage=r,self.callback&&self.callback()}),addEventListener("message",function(e){self.callback=function(){var t=self.extractColorFromImage(e.data.imageData,e.data.width,e.data.height,e.data.swatchCount,e.data.colorMood);this.postMessage(t)},self.extractColorFromImage&&self.callback()},!1),addEventListener("error",function(){this.postMessage("Error")},!1),define("utils/worker",function(){});